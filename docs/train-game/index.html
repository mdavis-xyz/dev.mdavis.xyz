<!DOCTYPE html>
<html lang="en">
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />

   <!--w3c-->
   <title property="schema:name">train game solver</title>
   <meta name="title" content="train game solver">
   <meta name="description" content="An algorithm for solving the maths problem known as The Train Game">

   <!--schema.org-->
   <meta property="schema:name" content="train game solver">
   <meta property="schema:description" content="An algorithm for solving the maths problem known as The Train Game">

   <!-- opengraph-->
   <meta property="og:title" content="train game solver">
   <meta property="og:description" content="An algorithm for solving the maths problem known as The Train Game">


   <meta property="og:type" content="website" />
   <meta property="og:url" content="https://www.mdavis.xyz/train-game" />

   <!-- https://www.tripadvisor.com.au/Attraction_Review-g255060-d8130880-Reviews-Sydney_Trains-Sydney_New_South_Wales.html#photos;aggregationId=101&albumid=101&filter=7&ff=349619996 -->
   <meta property="og:image" content="https://www.mdavis.xyz/train-game/pics/card.jpg" />
   <meta property="og:image:width" content="677" />
   <meta property="og:image:height" content="1000" />
   <meta property="og:author" content="Matthew Davis" />
   <meta property="og:site_name" content="Matthew Davis's Blog" />

   <meta name="displaydate" content="10 Feb 2019">

   <meta name="viewport" content="width=device-width, initial-scale=1.0" />

   <link rel="stylesheet" type="text/css" href="styles.css" />

   <link rel="stylesheet" type="text/css" href="../common.css" />
   <link rel="stylesheet" type="text/css" href="../media.css" />

   <script src="script.js" type="text/javascript"></script>
   <script src="../source.js" type="text/javascript"></script>

   <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript" async></script>

</head>
<body>
   <div class="appear">

   <article>


      <header>
         <h1 id="title">train game solver</h1>
         <p id="subtitle" class="subtitle">An algorithm for solving the maths problem known as The Train Game</p>
      </header>


      <p class="topimagecont">
         <img class="topimage"
              src="pics/card.jpg"
              alt="Train"
              width="677"
              height="1000" />
      </p>


      <div class="authordate center">
         <a id="author" href="../">
            <div class="metaline">
               <img
                   class="logo"
                   src="../images/user.svg"
                   alt=""
                   width="20"
                   height="20" />
               <span class="byline-name">
                  Matthew Davis
               </span>
            </div>
         </a>
         <div class="metalinesep">
            |
         </div>
         <div class="metaline">
            <img
                class="logo"
                src="../images/calendar.svg"
                alt=""
                width="20"
                height="20" />
            <time datetime="2019-02-10" class="dateline">
               10 Feb 2019
            </time>
         </div>
         <div class="metalinesep">
            |
         </div>
         <div class="metaline">
            <img
                class="logo"
                src="../images/stopwatch.svg"
                alt=""
                width="20"
                height="20" />
            2 min
         </div>

      </div>


      <hr/>
      <h2>
   What is the Train Game?
</h2>
<p>
<i>The Train Game</i> is a maths game to help you pass the time during long train trips.
The aim of the game is to take a number (such as the carriage number on that boring train trip)
and to compose an expression using those digits in order, which equals a target (typically 10).
</p>
<p>
For example, the carriage number in this photo is 1802.

<div class="center">
   <img class="niceImage" src="pics/num4-a.jpg" alt="Train Carriage Number" width="563" height="1000">
</div>

One solution for this number is $$1 \times 8 + 0 + 2 = 10$$

Another example is the number 4342, which can be solved with

$$4 \times 3 - \frac{4}{2} = 10$$

</p>
<p>
Typically the input number is 4 digits long.
Some people play a variation where the digit order may be changed.
</p>
<p>
For a target of 10, a brute-force algorithm (described later)
was used to calculate that 81% of of 4 digit problems are solvable with just addition, subtraction, multiplication and division.
To solve the remaining 19% of problems, one must resort to more exotic functions such as logarithms, factorials and trigonometric functions.
For example, a solution for the number 2823 is

$$\left(log_2(8)\right)! -2 + 3! = 10$$
</p>


<h2 id="solver-header">
   The Solver
</h2>

<p>
   This tool will solve any train game problem for you.
   You may choose a target other than 10.
   The list of allowed functions can be modified to suit the version you play.
   (Not everyone allows exotic functions.)
</p>

<div class="center">
<form
    id="solver"
    action="https://us-central1-traingame-202010.cloudfunctions.net/train-game-solve"
    target="result_frame"
    method="get">
   <div id="input-flex">
   <div>
      <div>
         Input Problem
      </div>
      <div>
          <input class="number digit" type="text" min=0 max=9 id="digit-0" name="digit-0" value=1>
          <input class="number digit" type="text" min=0 max=9 id="digit-1" name="digit-1" value=2>
          <input class="number digit" type="text" min=0 max=9 id="digit-2" name="digit-2" value=3>
          <input class="number digit" type="text" min=0 max=9 id="digit-3" name="digit-3" value=4>
      </div>

      <div>
         Target
      </div>
      <div>
         <input class="number digits" type="number" id="target" name="target" value=10>
      </div>
   </div>
   <ul id="opslist" name="opslist">
      <li>
         <label>
            <input type="checkbox" id="basic" name="basic" checked>
               Basics (+,- &#215;, &#247;)
            </input>
         </label>
      </li>
      <li>
         <label>
            <input type="checkbox" id="power" name="power">
               Powers
            </input>
         </label>
      </li>
      <li>
         <label>
            <input type="checkbox" id="root" name="root">
               Roots
            </input>
         </label>
      </li>
      <li>
         <label>
            <input type="checkbox" id="factorial" name="factorial">
               Factorials
            </input>
         </label>
      </li>
      <li>
         <label>
            <input type="checkbox" id="trigdeg" name="trigdeg">
               Trigonometry (degrees)
            </input>
         </label>
      </li>
      <li>
         <label>
            <input type="checkbox" id="trigrad" name="trigrad">
               Trigonometry (radians)
            </input>
         </label>
      </li>
      <li>
         <label>
            <input type="checkbox" id="log" name="log">
               Logarithms
            </input>
         </label>
      </li>
   </ul>
   </div>
   <input type="hidden" name="format" value="html-web">
   <input id="submit" type="submit" value="Calculate" class="button"></input>
   <div class="center">
      <iframe id="result_frame" name="result_frame" class="center">
      </iframe>
   </div>
</form>




</div>
<h2>
   How The Solver Works
</h2>

<h3>
   General Approach
</h3>

<p>
For this solver an algorithm was constructed to solve the Train Game using brute force.
When only using addition, subtraction, multiplication and division such a calculation is straightforward.
However if the algorithm considers other functions such as logarithms, factorials and trigonometric functions,
then these functions may be nested to arbitrary depths.
For example, a simple yet poor brute force algorith may try:

<ul>
   <li> \(2+3+4+5 \neq 10\)</li>
   <li> \(\cos(2)+3+4+5 \neq 10\)</li>
   <li> \(\cos(2)!+3+4+5 \neq 10\)</li>
   <li> \(\ln\left(\cos(2)!\right)+3+4+5 \neq 10\)</li>
   <li> \(\tan^{-1}\left(\cos\left(\ln\left(\cos(2)!\right)\right)\right)+3+4+5 \neq 10\)</li>
</ul>
</p>

<p>
The set of all possible expressions can be thought of as an infinite dimensional
vector space.
A brute force algorithm must try to exhaustively traverse this space in a <i>breadth-first</i> approach.
, and increases by \(\mathcal{O}\left(e^{n}\right)\) where \(n\) is the number of operations.
</p>
<p>
The algorithm must also consider all possible permutations of brackets.
For a 4 digit number, there are 5 possibilities, which were hard coded.
</p>

<h3>
   Trig Factorial Trick
</h3>

<p>
When solving the Train Game, the presence of a 1 or 0 is very useful.
Zeros can be used to eliminate surplus digits.
For example the problem 5203 can be solved with \(5\times2 + 0\times 3=10\) .
Zeros can also be used to convert any other digit (or expression of digits) to a 1, which is also useful.
For example \(9+(3+6)^0=9+1=10\).
Ones are useful because they can be used to consume undesirable digits.
For example, \(6+4\times\sqrt[2]{1}=6+4=10\).
</p>

<p>
Given these tricks, a method of constructing an expression to transform any digit
into a 1 or 0 would be very helpful for input numbers which lack a 0 or 1 digit.
The following proof by induction proves that \(\sin(n!!)=0\)
and \(\cos(n!!)=1\) for all integers \(n>2\) (when calculating in degrees).
</p>

<p>
\(3!! = 720\) is a multiple of 360. Therefore \(\cos(3!!)=1\) and \(\sin(3!!)=0\) (when using degrees).
</p>

<p>
If \(n!!\) is a multiple of 360, then the following is also a multiple of 360.

$$(n+1)!!=n!!\times\Pi_{m=(n+1)!+1}^{m=(n+1)!}m!$$

Therefore \(\sin((n+1)!!)=0\)
and \(\cos((n+1)!!)=1\).
</p>

<p>
Therefore, by induction, \(\cos(n!!)=1\) and \(\sin(n!!)=0\) for all integers \(n\geq{}3\).
</p>

<p>
This discovery is very valuable for seemingly unsolvable Train Game problems.
For example, the number 7395 can be solved with

$$7+3+\sin\left((9+5)!!\right)=7+3+0=10$$
</p>

<p>
For integers larger than 5, the second factorial is redundant.
It was left in to make the proof simpler.
</p>


<h3>
   Solving 0000
</h3>

<!-- TODO:  Finish -->

<h3>
   Generalised Approach
</h3>

<!-- TODO:  Finish -->


   </article>


   <nav>
      <hr/>
      <p class="footer">
         <a href="../">find more by Matthew Davis</a>
      </p>
   </nav>

   </div>

</body>
</html>
